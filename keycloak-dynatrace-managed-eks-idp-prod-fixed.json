{
  "dashboardMetadata": {
    "name": "Keycloak 26.4.7 - EKS PROD (Dynatrace Managed)",
    "shared": true,
    "owner": "IAM / Platform"
  },
  "tiles": [
    {
      "name": "HTTP Availability (Requests)",
      "tileType": "DATA_EXPLORER",
      "configured": true,
      "bounds": { "top": 0, "left": 0, "width": 380, "height": 220 },
      "queries": [
        {
          "metric": "http.server.requests.count",
          "aggregation": "SUM",
          "filterBy": {
            "filterOperator": "AND",
            "filters": [
              { "dimensionKey": "k8s.namespace.name", "dimensionValue": "idp-prod-keycloa-masu" }
            ]
          }
        }
      ],
      "visualConfig": { "type": "SINGLE_VALUE" }
    },
    {
      "name": "HTTP Latency p95",
      "tileType": "DATA_EXPLORER",
      "configured": true,
      "bounds": { "top": 0, "left": 380, "width": 380, "height": 220 },
      "queries": [
        {
          "metric": "http.server.requests.duration",
          "aggregation": "P95",
          "filterBy": {
            "filterOperator": "AND",
            "filters": [
              { "dimensionKey": "k8s.namespace.name", "dimensionValue": "idp-prod-keycloa-masu" }
            ]
          }
        }
      ],
      "visualConfig": { "type": "LINE" }
    },
    {
      "name": "HTTP 5xx Errors",
      "tileType": "DATA_EXPLORER",
      "configured": true,
      "bounds": { "top": 220, "left": 0, "width": 760, "height": 220 },
      "queries": [
        {
          "metric": "http.server.requests.count",
          "aggregation": "SUM",
          "filterBy": {
            "filterOperator": "AND",
            "filters": [
              { "dimensionKey": "http.status_code", "dimensionValue": "5*" },
              { "dimensionKey": "k8s.namespace.name", "dimensionValue": "idp-prod-keycloa-masu" }
            ]
          }
        }
      ],
      "visualConfig": { "type": "LINE" }
    },
    {
      "name": "Pod CPU Usage",
      "tileType": "DATA_EXPLORER",
      "configured": true,
      "bounds": { "top": 440, "left": 0, "width": 380, "height": 220 },
      "queries": [
        {
          "metric": "k8s.pod.cpu.usage",
          "aggregation": "AVG",
          "splitBy": [ "k8s.pod.name" ]
        }
      ],
      "visualConfig": { "type": "AREA" }
    },
    {
      "name": "Pod Memory Usage",
      "tileType": "DATA_EXPLORER",
      "configured": true,
      "bounds": { "top": 440, "left": 380, "width": 380, "height": 220 },
      "queries": [
        {
          "metric": "k8s.pod.memory.usage",
          "aggregation": "AVG",
          "splitBy": [ "k8s.pod.name" ]
        }
      ],
      "visualConfig": { "type": "AREA" }
    },
    {
      "name": "Login Failures (Logs)",
      "tileType": "LOG_ANALYTICS",
      "configured": true,
      "bounds": { "top": 660, "left": 0, "width": 760, "height": 260 },
      "query": "fetch logs | filter k8s.namespace.name == \"idp-prod-keycloa-masu\" | filter contains(content, \"LOGIN_ERROR\") | summarize count() by bin(timestamp, 5m)",
      "visualConfig": { "type": "BAR" }
    }
  ]
}